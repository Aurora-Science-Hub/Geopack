      PROGRAM COMPREHENSIVE_GEOPACK_BENCHMARK
      IMPLICIT REAL*8 (A-H,O-Z)

      PARAMETER (LMAX=500)
      DIMENSION XX(LMAX),YY(LMAX),ZZ(LMAX), PARMOD(10)
      DIMENSION XTRACE(LMAX), YTRACE(LMAX), ZTRACE(LMAX)

      INTEGER NUM_RUNS, I
      PARAMETER (NUM_RUNS=1000)
      REAL*8 START_TIME, END_TIME
      REAL*8 T_VALUE
      PARAMETER (T_VALUE=3.300D0)

      REAL*8 TOTAL_TIME, AVG_TIME, SUM_SQ, STD_DEV, ERROR_VAL
      REAL*8 AVG_TIME_RECALC

      REAL*8 HXGSW, HYGSW, HZGSW, BR, BTHETA, BPHI
      REAL*8 BXGSW, BYGSW, BZGSW, GST, SLONG, SRASN, SDEC
      REAL*8 X, Y, Z, R, THETA, PHI, BX, BY, BZ
      REAL*8 XGEO, YGEO, ZGEO, XMAG, YMAG, ZMAG
      REAL*8 XGEI, YGEI, ZGEI, XSM, YSM, ZSM
      REAL*8 XGSE, YGSE, ZGSE, H, XMU, RR, THETAR
      REAL*8 XMGNP, YMGNP, ZMGNP, DIST
      REAL*8 XF, YF, ZF
      INTEGER ID, M, L

      EXTERNAL T89D_DP, IGRF_GSW_08, DIP_08

      IYEAR = 1997
      IDAY = 345
      IHOUR = 10
      MIN = 10
      ISEC = 0
      VGSEX = -304.0D0
      VGSEY = 14.78D0
      VGSEZ = 4.0D0

      DO I = 1, 10
          PARMOD(I) = 0.0D0
      END DO

      WRITE (*,*) 'COMPREHENSIVE GEOPACK-2008 BENCHMARK'
      WRITE (*,*) '==================================='
      WRITE (*,'(A,I6)') 'NUMBER OF RUNS: ', NUM_RUNS
      WRITE (*,*) ''

c       CALL RECALC_08(IYEAR, IDAY, IHOUR, MIN, ISEC, VGSEX, VGSEY, VGSEZ)

      XGSW = -1.02D0
      YGSW = 1.02D0
      ZGSW = 1.02D0

      R = 1.02D0
      THETA = 0.7D0
      PHI = 1.4D0

      BX = 1.0D0
      BY = 1.0D0
      BZ = 1.0D0

      BR = 1.0D0
      BTHETA = 1.0D0
      BPHI = 1.0D0

      H = 100.0D0
      XMU = 1.04719D0
      RR = 6462.13176D0
      THETAR = 0.526464D0

      XN_PD = 5.0D0
      VEL = -350.0D0
      BZIMF = 5.0D0

      DIR1 = -1.D0
      DIR2 = 1.D0
      DSMAX_TRACE = 0.1D0
      ERR = 0.0001D0
      RLIM = 60.D0
      R0 = 1.D0
      IOPT = 1
      XGSW1 = -0.1059965956329907D0
      YGSW1 = 0.41975266827470664D0
      ZGSW1 = -0.9014246640527153D0
      XGSW2 = -0.45455707401565865D0
      YGSW2 = 0.4737969930623606D0
      ZGSW2 = 0.7542497890011055D0

      WRITE (*,*) 'FUNCTION                AVERAGE TIME (nS)    ',
     *            'STD DEV (nS)    ERROR (nS)    RATIO'
      WRITE (*,*) '-------------------    -----------------    ',
     *            '-------------    ----------    -----'

C     Benchmark 0: RECALC_08 (baseline)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL RECALC_08(IYEAR, IDAY, IHOUR, MIN, ISEC,
     *                   VGSEX, VGSEY, VGSEZ)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *        AVG_TIME_RECALC, STD_DEV_RECALC, ERROR_VAL_RECALC)
      PRINT *, 'RECALC_08 completed'

C     Benchmark 1: IGRF_GSW_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL IGRF_GSW_08(XGSW, YGSW, ZGSW, HXGSW, HYGSW, HZGSW)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'IGRF_GSW_08         ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 2: IGRF_GEO_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL IGRF_GEO_08(R, THETA, PHI, BR, BTHETA, BPHI)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'IGRF_GEO_08         ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 3: DIP_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL DIP_08(XGSW, YGSW, ZGSW, BXGSW, BYGSW, BZGSW)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'DIP_08             ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 4: SUN_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL SUN_08(IYEAR, IDAY, IHOUR, MIN, ISEC, GST, SLONG,
     *                SRASN, SDEC)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'SUN_08             ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 5: SPHCAR_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL SPHCAR_08(R, THETA, PHI, X, Y, Z, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'SPHCAR_08 (J>0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 6: SPHCAR_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL SPHCAR_08(R, THETA, PHI, X, Y, Z, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'SPHCAR_08 (J<0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 7: BSPCAR_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL BSPCAR_08(THETA, PHI, BR, BTHETA, BPHI, BX, BY, BZ)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'BSPCAR_08          ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 8: BCARSP_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL BCARSP_08(X, Y, Z, BX, BY, BZ, BR, BTHETA, BPHI)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'BCARSP_08          ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 9: GEOMAG_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      XGEO = XGSW
      YGEO = YGSW
      ZGEO = ZGSW
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEOMAG_08(XGEO, YGEO, ZGEO, XMAG, YMAG, ZMAG, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEOMAG_08 (J>0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 10: GEOMAG_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEOMAG_08(XGEO, YGEO, ZGEO, XMAG, YMAG, ZMAG, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEOMAG_08 (J<0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 11: GEIGEO_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      XGEI = XGSW
      YGEI = YGSW
      ZGEI = ZGSW
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEIGEO_08(XGEI, YGEI, ZGEI, XGEO, YGEO, ZGEO, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEIGEO_08 (J>0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 12: GEIGEO_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEIGEO_08(XGEI, YGEI, ZGEI, XGEO, YGEO, ZGEO, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEIGEO_08 (J<0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 13: MAGSM_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      XMAG = XGSW
      YMAG = YGSW
      ZMAG = ZGSW
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL MAGSM_08(XMAG, YMAG, ZMAG, XSM, YSM, ZSM, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'MAGSM_08 (J>0)     ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 14: MAGSM_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL MAGSM_08(XMAG, YMAG, ZMAG, XSM, YSM, ZSM, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'MAGSM_08 (J<0)     ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 15: SMGSW_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      XSM = XGSW
      YSM = YGSW
      ZSM = ZGSW
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL SMGSW_08(XSM, YSM, ZSM, XGSW, YGSW, ZGSW, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'SMGSW_08 (J>0)     ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 16: SMGSW_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL SMGSW_08(XSM, YSM, ZSM, XGSW, YGSW, ZGSW, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'SMGSW_08 (J<0)     ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 17: GEOGSW_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      XGEO = XGSW
      YGEO = YGSW
      ZGEO = ZGSW
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEOGSW_08(XGEO, YGEO, ZGEO, XGSW, YGSW, ZGSW, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEOGSW_08 (J>0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 18: GEOGSW_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEOGSW_08(XGEO, YGEO, ZGEO, XGSW, YGSW, ZGSW, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEOGSW_08 (J<0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 19: GEODGEO_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEODGEO_08(H, XMU, R, THETA, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEODGEO_08 (J>0)   ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 20: GEODGEO_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GEODGEO_08(H, XMU, R, THETA, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GEODGEO_08 (J<0)   ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 21: GSWGSE_08 (J>0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GSWGSE_08(XGSW, YGSW, ZGSW, XGSE, YGSE, ZGSE, 1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GSWGSE_08 (J>0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 22: GSWGSE_08 (J<0)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL GSWGSE_08(XGSW, YGSW, ZGSW, XGSE, YGSE, ZGSE, -1)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'GSWGSE_08 (J<0)    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 23: SHUETAL_MGNP_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL SHUETAL_MGNP_08(XN_PD, VEL, BZIMF, XGSW, YGSW, ZGSW,
     *        XMGNP, YMGNP, ZMGNP, DIST, ID)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'SHUETAL_MGNP_08    ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 24: T96_MGNP_08
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL T96_MGNP_08(XN_PD, VEL, XGSW, YGSW, ZGSW,
     *        XMGNP, YMGNP, ZMGNP, DIST, ID)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'T96_MGNP_08        ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 25: TRACE_08 (DIR=-1)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL TRACE_08(XGSW1, YGSW1, ZGSW1, DIR1, DSMAX_TRACE, ERR,
     *        RLIM, R0, IOPT, PARMOD, T89D_DP, IGRF_GSW_08,
     *        XF, YF, ZF, XX, YY, ZZ, M, LMAX)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'TRACE_08 (DIR=-1)  ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 26: TRACE_08 (DIR=+1)
      TOTAL_TIME = 0.0D0
      SUM_SQ = 0.0D0
      DO I = 1, NUM_RUNS
          CALL CPU_TIME(START_TIME)
          CALL TRACE_08(XGSW2, YGSW2, ZGSW2, DIR2, DSMAX_TRACE, ERR,
     *        RLIM, R0, IOPT, PARMOD, T89D_DP, IGRF_GSW_08,
     *        XF, YF, ZF, XX, YY, ZZ, M, LMAX)
          CALL CPU_TIME(END_TIME)
          TOTAL_TIME = TOTAL_TIME + (END_TIME - START_TIME)
          SUM_SQ = SUM_SQ + (END_TIME - START_TIME)**2
      END DO
      CALL COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                   AVG_TIME, STD_DEV, ERROR_VAL)
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'TRACE_08 (DIR=+1)  ',
     *     AVG_TIME * 1D9, STD_DEV * 1D9, ERROR_VAL * 1D9,
     *     AVG_TIME/AVG_TIME_RECALC

C     Benchmark 27: RECALC_08
      WRITE (*,'(A, F15.3, 2F15.3, F10.3)') 'RECALC_08          ',
     *     AVG_TIME_RECALC * 1D9, STD_DEV_RECALC * 1D9,
     *     ERROR_VAL_RECALC * 1D9, 1.0D0

      WRITE (*,*) ''
      WRITE (*,*) 'BENCHMARK COMPLETED SUCCESSFULLY'
      WRITE (*,*) 'Note: Ratios are relative to RECALC_08'

      END

      SUBROUTINE COMPUTE_STATS(TOTAL_TIME, SUM_SQ, NUM_RUNS, T_VALUE,
     *                         AVG_TIME, STD_DEV, ERROR_VAL)
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER NUM_RUNS
      REAL*8 TOTAL_TIME, SUM_SQ, T_VALUE, AVG_TIME, STD_DEV, ERROR_VAL

      AVG_TIME = TOTAL_TIME / DBLE(NUM_RUNS)
      STD_DEV = SQRT((SUM_SQ - TOTAL_TIME * AVG_TIME)
     *         / DBLE(NUM_RUNS - 1))
      ERROR_VAL = (T_VALUE * STD_DEV / SQRT(DBLE(NUM_RUNS))) / 2.0D0

      RETURN
      END
