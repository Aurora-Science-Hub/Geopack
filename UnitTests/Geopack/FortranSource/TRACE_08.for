      PROGRAM TRACE_08_TESTDATA

      IMPLICIT REAL*8 (A-H,O-Z)

      PARAMETER (LMAX=500)
      DIMENSION XX(LMAX),YY(LMAX),ZZ(LMAX), PARMOD(10)

      EXTERNAL T89D_DP,IGRF_GSW_08

      IYEAR=1997
      IDAY=350
      IHOUR=21
      MIN=0
      ISEC=0

      VGSEX=-400.0D0
      VGSEY= 0.0D0
      VGSEZ= 0.0D0

      CALL RECALC_08 (IYEAR,IDAY,IHOUR,MIN,ISEC,VGSEX,VGSEY,VGSEZ)

      OPEN(UNIT=1,FILE='TraceSNResult.dat')

      DIR=-1.D0
      DSMAX=0.1D0
      ERR=0.0001D0
      RLIM=60.D0
      R0=1.D0
      IOPT=1
      XGSW=-1.02D0
      YGSW=0.8D0
      ZGSW=-0.9D0

      CALL TRACE_08 (XGSW,YGSW,ZGSW,DIR,DSMAX,ERR,RLIM,R0,IOPT,
     * PARMOD,T89D_DP,IGRF_GSW_08,XF,YF,ZF,XX,YY,ZZ,M,LMAX)

        WRITE (1,21) (XX(L),YY(L),ZZ(L),L=1,M)
 21     FORMAT ((2X,3F32.23))

      CLOSE(UNIT=1)
      END
